if ((typeof(dmfp$35$36$3counterTransitive$3js$0dmfp$35$36$3counterTransitive$3js$1)) == "undefined") {dmfp$35$36$3counterTransitive$3js$0dmfp$35$36$3counterTransitive$3js$1 = {};
};
(function(){basis$0General$1.print$163("<html><body><h2>counterTransitive returns the pairs missing that would make its relation argument transitive</h2><table border='1'><tr><th align='left'>Relation:(e.g. (5,2),(3,1)</th><td><input type='text' id='jL1'></td></tr><tr><th align='left'>Missing pairs needed:</th><td><div id='jR'>?</div></td></tr></table>The time is <span id='timer'>not initialized</span></body></html>");
dmfp$35$36$3counterTransitive$3js$0dmfp$35$36$3counterTransitive$3js$1.get$54 = function(id$57){var v$62 = (function(d,id){return SmlPrims.option(d.getElementById(id));})(js$0Js$1.document$88,id$57);
switch (v$62[0]) { case 0: {return v$62[1];
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"Missing id in document: " + id$57];
} };
};
dmfp$35$36$3counterTransitive$3js$0dmfp$35$36$3counterTransitive$3js$1.input1$65;
var v$260 = (function(d,id){return SmlPrims.option(d.getElementById(id));})(js$0Js$1.document$88,"jL1");
switch (v$260[0]) { case 0: {dmfp$35$36$3counterTransitive$3js$0dmfp$35$36$3counterTransitive$3js$1.input1$65 = v$260[1];
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"Missing id in document: jL1"];
} };
(function(fp,s,v){fp[s] = v;})((function(fp,s){return fp[s];})(dmfp$35$36$3counterTransitive$3js$0dmfp$35$36$3counterTransitive$3js$1.input1$65,"style"),"backgroundColor","yellow");
rwp$0Rwp$1.insertDOM$572("timer",rwp$0Rwp$1.arr$952(function(v$243){return (v$243[0][0] == v$243[1][0])?(v$243[0][1] == v$243[1][1]):false;
},function(v$246){return v$246[0] == v$246[1];
},function(x$271){return basis$0Date$1.toString$826(basis$0Date$1.fromTimeLocal$512(x$271[0],x$271[1]));
},rwp$0Rwp$1.timer$918(100)));
var fix$499 = {};
fix$499.$isRelatedTo = function(v$247,v$248,v$71){lab$isRelatedTo: while (true) {var v$83 = v$71[2];
if (v$83 == null) {return false;
} else {var v$94 = v$71[0];
var v$95 = v$71[1];
var v$96 = v$83;
var v$97 = v$96[0];
var v$98 = v$97[0];
var v$99 = v$97[1];
var v$100 = v$96[1];
if ((v$248([v$94,v$98]))?(v$247([v$95,v$99])):false) {return true;
} else {var t$500 = v$247;
var t$501 = v$248;
var t$502 = [v$94,v$95,v$100];
var v$247 = t$500;
var v$248 = t$501;
var v$71 = t$502;
continue lab$isRelatedTo;
};
};
};
};
dmfp$35$36$3counterTransitive$3js$0dmfp$35$36$3counterTransitive$3js$1.isRelatedTo$68 = fix$499.$isRelatedTo;
dmfp$35$36$3counterTransitive$3js$0dmfp$35$36$3counterTransitive$3js$1.counterTransitive$101 = function(v$249,relation$104){var fix$503 = {};
fix$503.$test = function(v$143){if (v$143 == null) {return null;
} else {var v$151 = v$143;
var v$152 = v$151[0];
var v$153 = v$152[0];
var v$154 = v$152[1];
var v$155 = v$151[1];
var t$513 = basis$0List$1.s$n$686;
var t$505;
var fix$504 = {};
fix$504.$testOnePair = function(v$493,v$323){if (v$323 == null) {return null;
} else {var v$330 = v$493[0];
var v$331 = v$493[1];
var v$332 = v$323;
var v$333 = v$332[0];
var v$334 = v$333[0];
var v$335 = v$333[1];
var v$336 = v$332[1];
var t$512 = basis$0List$1.s$n$686;
var t$511;
var t$510;
if ((v$249([v$331,v$334]))?false:true) {t$510 = true;
} else {var fix$506 = {};
fix$506.$isRelatedTo = function(v$494,v$495,v$469){lab$isRelatedTo: while (true) {if (v$469 == null) {return false;
} else {var v$472 = v$469;
var v$473 = v$472[0];
var v$474 = v$473[0];
var v$475 = v$473[1];
var v$476 = v$472[1];
if ((v$249([v$494,v$474]))?(v$249([v$495,v$475])):false) {return true;
} else {var t$507 = v$494;
var t$508 = v$495;
var t$509 = v$476;
var v$494 = t$507;
var v$495 = t$508;
var v$469 = t$509;
continue lab$isRelatedTo;
};
};
};
};
var isRelatedTo$467 = fix$506.$isRelatedTo;
t$510 = (isRelatedTo$467(v$330,v$335,relation$104));
};
t$511 = (t$510?null:[[v$330,v$335],null]);
return t$512(t$511,fix$504.$testOnePair([v$330,v$331],v$336));
};
};
var testOnePair$319 = fix$504.$testOnePair;
t$505 = (testOnePair$319([v$153,v$154],relation$104));
return t$513(t$505,fix$503.$test(v$155));
};
};
var test$140 = fix$503.$test;
return test$140(relation$104);
};
dmfp$35$36$3counterTransitive$3js$0dmfp$35$36$3counterTransitive$3js$1.makeRelation$156 = function(s$159){var fix$514 = {};
fix$514.$makePairs = function(v$167){if (v$167 == null) {return null;
} else {var v$176 = v$167;
var v$177 = v$176[1];
if (v$177 == null) {throw CompilerInitial.exn$Match$48;
} else {var v$179 = v$176[0];
var v$180 = v$177;
var v$181 = v$180[0];
var v$182 = v$180[1];
return [[v$179,v$181],fix$514.$makePairs(v$182)];
};
};
};
var makePairs$164 = fix$514.$makePairs;
return makePairs$164(basis$0List$1.map$697(function(x$385){return basis$0General$1.valOf$130(basis$0Int32$1.fromString$462(x$385));
},basis$0String$1.tokens$224(function(c$386){return basis$0Char$1.isPunct$233(c$386);
},s$159)));
};
var fix$515 = {};
fix$515.$makeStringFromRelation = function(v$186){if (v$186 == null) {return "";
} else {var v$194 = v$186;
var v$195 = v$194[0];
var v$196 = v$195[0];
var v$197 = v$195[1];
var v$198 = v$194[1];
return ((((("(" + (basis$0Int32$1.toString$458(v$196))) + ",") + (basis$0Int32$1.toString$458(v$197))) + ")") + ",") + (fix$515.$makeStringFromRelation(v$198));
};
};
dmfp$35$36$3counterTransitive$3js$0dmfp$35$36$3counterTransitive$3js$1.makeStringFromRelation$183 = fix$515.$makeStringFromRelation;
dmfp$35$36$3counterTransitive$3js$0dmfp$35$36$3counterTransitive$3js$1.removeComma$199 = function(s$202){var v$496;
var v$492 = s$202.length;
v$496 = ((1 > v$492)?[s$202,0,0]:[s$202,0,SmlPrims.chk_ovf_i32(v$492 - 1)]);
return basis$0Substring$1.string$117(v$496[0],v$496[1],v$496[2]);
};
dmfp$35$36$3counterTransitive$3js$0dmfp$35$36$3counterTransitive$3js$1.comp$203 = function(v$205){var v$206 = (function(e){return e.value;})(dmfp$35$36$3counterTransitive$3js$0dmfp$35$36$3counterTransitive$3js$1.input1$65);
var res$207;
var s$400 = dmfp$35$36$3counterTransitive$3js$0dmfp$35$36$3counterTransitive$3js$1.makeStringFromRelation$183(dmfp$35$36$3counterTransitive$3js$0dmfp$35$36$3counterTransitive$3js$1.counterTransitive$101(function(v$251){return v$251[0] == v$251[1];
},dmfp$35$36$3counterTransitive$3js$0dmfp$35$36$3counterTransitive$3js$1.makeRelation$156(v$206)));
var v$497;
var v$489 = s$400.length;
v$497 = ((1 > v$489)?[s$400,0,0]:[s$400,0,SmlPrims.chk_ovf_i32(v$489 - 1)]);
res$207 = (basis$0Substring$1.string$117(v$497[0],v$497[1],v$497[2]));
var r$208;
var v$408 = (function(d,id){return SmlPrims.option(d.getElementById(id));})(js$0Js$1.document$88,"jR");
switch (v$408[0]) { case 0: {r$208 = v$408[1];
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"Missing id in document: jR"];
} };
(function(fp,s,v){fp[s] = v;})((function(fp,s){return fp[s];})(r$208,"style"),"backgroundColor","pink");
(function(e,s){e.innerHTML = s;})(r$208,res$207);
return false;
};
js$0Js$1.installEventHandler$197(dmfp$35$36$3counterTransitive$3js$0dmfp$35$36$3counterTransitive$3js$1.input1$65,5,function(v$498){return dmfp$35$36$3counterTransitive$3js$0dmfp$35$36$3counterTransitive$3js$1.comp$203(v$498);
});
return 0;
})();
